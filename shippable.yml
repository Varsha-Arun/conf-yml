language: python

python:
  - 2.7
  - 3.7
  - pypy
  - pypy3

runtime:
  - nodePool: dynamic__x86_64__Ubuntu_16_04__c4_large
  - nodePool: dynamic__x86_64__Ubuntu_14_04__c4_xlarge
 # - nodePool: dynamic__x86_64__WindowsServer_2016__c4_2xlarge

matrix: 
#  include:
#    - nodePool: dynamic__x86_64__Ubuntu_14_04__c4_xlarge
#      env: INCLUDE=matrixinclude_U14
#    - nodePool: dynamic__x86_64__Ubuntu_16_04__c4_large
#      env: INCLUDE=matrixinclude_U16
  exclude:
    - python: pypy
      nodePool: dynamic__x86_64__Ubuntu_16_04__c4_large
    #- python: pypy
   #   nodePool: dynamic__x86_64__CentOS_7__c4_large
  allow_failures:
    - python: pypy3
      nodePool: dynamic__x86_64__Ubuntu_16_04__c4_large
    - python: pypy3
      nodePool: dynamic__x86_64__Ubuntu_14_04__c4_xlarge
    
build:
  ci: 
    - python -V 
    - if [ "$SHIPPABLE_PYTHON_VERSION" == "pypy3" ]; then testfail; fi
